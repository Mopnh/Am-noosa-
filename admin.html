<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>صفحة الأدمن - أم نوسه للبقلاوة</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,sans-serif}
body{background:#111;color:#ffd700;min-height:100vh;padding:20px}

/* Login Form */
#loginForm, #adminPanel{max-width:500px;margin:50px auto;padding:30px;background:rgba(0,0,0,.7);border-radius:20px;box-shadow:0 0 20px #ffd700;}
#loginForm h2, #adminPanel h2{text-align:center;margin-bottom:20px}
input[type=text], input[type=password], input[type=url]{
  width:100%;padding:10px;margin:10px 0 20px;border-radius:12px;border:none;font-size:16px;
}
button{padding:12px 20px;border:none;border-radius:12px;background:#ffd700;color:#000;font-weight:900;cursor:pointer;transition:all .3s ease;}
button:hover{transform:scale(1.05);box-shadow:0 0 15px #ffd700;}

/* Product List */
.product-list{margin-top:30px}
.product-item{display:flex;justify-content:space-between;align-items:center;background:rgba(255,215,0,.1);padding:10px 15px;margin-bottom:10px;border-radius:12px;}
.product-item img{width:60px;height:60px;object-fit:cover;border-radius:10px;}
.product-item span{flex:1;margin:0 15px;font-size:16px}
.product-item button{padding:6px 12px;margin-left:6px;font-size:14px;}
</style>
</head>
<body>

<div id="loginForm">
<h2>تسجيل دخول الأدمن</h2>
<input type="text" id="username" placeholder="اسم المستخدم">
<input type="password" id="password" placeholder="كلمة المرور">
<button onclick="login()">دخول</button>
<p id="loginMsg" style="color:red;text-align:center;margin-top:10px;"></p>
</div>

<div id="adminPanel" style="display:none;">
<h2>لوحة التحكم - الأدمن</h2>

<h3>إضافة منتج جديد</h3>
<input type="text" id="productName" placeholder="اسم المنتج">
<input type="url" id="productImage" placeholder="رابط صورة المنتج">
<button onclick="addProduct()">إضافة المنتج</button>

<div class="product-list" id="productList"></div>

</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
// Firebase init
firebase.initializeApp({
  apiKey: "AIzaSyDN4RgHt3jF8AkKpZ7eAZYtMZISoMddyRI",
  authDomain: "umnosa-baklava.firebaseapp.com",
  projectId: "umnosa-baklava"
});
const db = firebase.firestore();

/* Login */
function login(){
  const user=document.getElementById("username").value;
  const pass=document.getElementById("password").value;
  const msg=document.getElementById("loginMsg");
  if(user==="moona97" && pass==="1997"){
    document.getElementById("loginForm").style.display="none";
    document.getElementById("adminPanel").style.display="block";
    loadProducts();
  }else{
    msg.textContent="اسم المستخدم أو كلمة المرور خاطئة!";
  }
}

/* Load Products */
function loadProducts(){
  const list=document.getElementById("productList");
  db.collection("products").orderBy("created","desc").onSnapshot(snapshot=>{
    list.innerHTML="";
    snapshot.forEach(doc=>{
      const p=doc.data();
      const div=document.createElement("div");
      div.className="product-item";
      div.innerHTML=`
        <img src="${p.image}">
        <span>${p.name}</span>
        <button onclick="editProduct('${doc.id}','${p.name}','${p.image}')">تعديل</button>
        <button onclick="deleteProduct('${doc.id}')">حذف</button>
      `;
      list.appendChild(div);
    });
  });
}

/* Add Product */
function addProduct(){
  const name=document.getElementById("productName").value.trim();
  const image=document.getElementById("productImage").value.trim();
  if(name && image){
    db.collection("products").add({
      name:name,
      image:image,
      created:firebase.firestore.FieldValue.serverTimestamp()
    }).then(()=>{
      document.getElementById("productName").value="";
      document.getElementById("productImage").value="";
    });
  }
}

/* Edit Product */
function editProduct(id,oldName,oldImage){
  const newName=prompt("تعديل اسم المنتج:",oldName);
  const newImage=prompt("تعديل رابط الصورة:",oldImage);
  if(newName && newImage){
    db.collection("products").doc(id).update({
      name:newName,
      image:newImage
    });
  }
}

/* Delete Product */
function deleteProduct(id){
  if(confirm("هل تريد حذف هذا المنتج؟")){
    db.collection("products").doc(id).delete();
  }
}
</script>

</body>
</html>
